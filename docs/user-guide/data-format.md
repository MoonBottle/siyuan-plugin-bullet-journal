# 数据格式

本文档详细介绍子弹笔记插件的任务和事项标记语法。

## 文档结构

项目文档分为三个主要区域，每个区域解析不同类型的信息：

![文档结构示意图](./images/data-format-structure.png)

### 1. 项目信息区（文档顶部）

位置：任务列表之前的内容

| 元素 | 格式 | 说明 |
|------|------|------|
| 项目名称 | `## 项目名称` | 文档标题 |
| 项目描述 | `> 项目描述` | 项目简述 |
| 项目链接 | `[链接名称](URL)` | 支持多个链接 |

### 2. 任务区

位置：包含 `#任务` 标记的内容

| 元素 | 格式 | 说明 |
|------|------|------|
| 任务标记 | `#任务` | 标识这是任务行 |
| 层级 | `@L1/@L2/@L3` | L1 一级任务，L2/L3 子任务 |
| 任务链接 | `[链接名称](URL)` | 关联文档或外部链接（单独一行） |

> ⚠️ 注意：任务本身不挂时间，时间都放在事项上

### 3. 事项区

位置：任务下方的内容（包含 `@` 但不含 `#任务`）

| 元素 | 格式 | 说明 |
|------|------|------|
| 工作事项 | 任意文本 + `@日期` | 事项内容 |
| 日期 | `@YYYY-MM-DD` | 事项日期 |
| 时间范围 | `@YYYY-MM-DD HH:mm~HH:mm` | 事项时间范围 |

## 标记说明

| 标记 | 说明 | 示例 |
|------|------|------|
| `##` | 项目名称 | `## 订单系统开发` |
| `>` | 项目描述 | `> 优化下单流程，提升转化率` |
| `#任务` | 标识为任务行 | `开发登录模块 #任务` |
| `@L1/@L2/@L3` | 任务层级 | `@L1` 一级任务，`@L2` 子任务 |
| `@YYYY-MM-DD` | 日期标记 | `@2026-02-25` |
| `@YYYY-MM-DD HH:mm:ss~HH:mm:ss` | 时间范围 | `@2026-02-25 14:00~16:00` |
| `[名称](URL)` | 链接 | `[需求文档](siyuan://blocks/202602...)` |

## 状态标签

事项可以通过标签标记状态，支持中英文：

| 状态 | 中文标签 | 英文标签 | 说明 |
|------|---------|---------|------|
| 待办 | 无（默认） | 无（默认） | 正常显示 |
| 已完成 | `#已完成` | `#done` | 显示删除线 |
| 已放弃 | `#已放弃` | `#abandoned` | 显示删除线 + 灰色 |

![状态标签显示效果](./images/data-format-status-tags.png)

**自动识别**：解析时同时支持中英文标签，会根据系统语言自动选择打标语言。

## 事项处理流程

```
当日事项（无标签）
    │
    ├─→ 完成 → 添加 #已完成（或 #done）
    │
    ├─→ 迁移 → 修改 @日期（明天或未来）
    │
    └─→ 放弃 → 添加 #已放弃（或 #abandoned）
```

![事项处理流程图](./images/data-format-workflow.png)

## 任务与事项的关系

任务和事项是层级关系：

```
任务（#任务 @L1）        ← 任务本身不带日期
├── 事项 @2026-02-20    ← 事项带日期
├── 事项 @2026-02-21    ← 同一任务下可以有多个事项
└── 子任务（#任务 @L2）
    └── 事项 @2026-02-22
```

![任务与事项层级关系图](./images/data-format-hierarchy.png)

**设计原因**：
- 任务代表一个目标或交付物
- 事项代表完成这个目标的具体行动
- 一个任务可能需要多天完成，每天有不同的工作事项

## 日期格式详解

### 基本日期

```markdown
事项名称 @2026-02-25
```

### 带时间范围

```markdown
事项名称 @2026-02-25 14:00~16:00
事项名称 @2026-02-25 14:00:00~16:00:00
```

> 💡 **提示**：时间范围会影响甘特图中的任务时长显示，并可在设置中配置扣除午休时间。

## 链接格式

支持两种链接类型：

### 外部链接

```markdown
[需求文档](https://example.com/requirements)
[研发甘特图](https://gantt.example.com/project123)
```

### 思源内部链接

```markdown
[登录模块设计](siyuan://blocks/20260220112000)
```

> 💡 **提示**：在思源笔记中，每个块都有唯一的 blockId，可以通过 `siyuan://blocks/` 协议直接跳转。

## 常见问题

### Q: 任务和事项的区别是什么？

任务是一个目标或交付物，事项是完成这个目标的具体行动。任务不带日期，事项必须带日期。

### Q: 如何让一个任务跨越多天？

在任务下创建多个事项，每个事项分配不同的日期：

```markdown
开发登录模块 #任务 @L1
需求评审 @2026-02-20
编码开发 @2026-02-21
测试验收 @2026-02-22
```

### Q: 如何标记任务完成？

任务本身没有状态，状态是标记在事项上的。当所有事项都完成后，可以认为任务完成。

### Q: 支持重复任务吗？

不支持。本插件的设计理念是「记录 > 提醒」，强调记录和回顾，而非提醒驱动。
